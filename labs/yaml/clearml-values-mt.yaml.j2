# Rendered by Jinja2 before Helm. NEVER commit the rendered file with secrets.
# Ingress / hostnames

apiserver:
  service: { type: ClusterIP }
  ingress:
    enabled: true
    ingressClassName: nginx
    hostName: "{{ APIURL | default('api-' ~ CLUSTER_ID ~ '.live.alta3.com') }}"
    annotations:
      nginx.ingress.kubernetes.io/proxy-body-size: "0"
      nginx.ingress.kubernetes.io/proxy-read-timeout: "600"
      nginx.ingress.kubernetes.io/proxy-send-timeout: "600"
  # (keep your existing service/ingress keys)
  extraEnv:
    # ----- enable "multi-tenancy" -----
    - name: CLEARML__enterprise__multi_tenant
      value: "true"
    - name: CLEARML__enterprise__superuser__name
      value: "{{ CLEARML_SUPERUSER_NAME | default('superadmin') }}"
    - name: CLEARML__enterprise__superuser__password
      valueFrom:
        secretKeyRef:
          name: clearml-secrets
          key: superadmin-password
    
    # ----- enable "fixed users" web login auth -----
    - name: CLEARML__apiserver__auth__fixed_users__enabled
      value: "true"
    - name: CLEARML__apiserver__auth__fixed_users__pass_hashed
      value: "false"


webserver:
  service: { type: ClusterIP }
  ingress:
    enabled: true
    ingressClassName: nginx
    hostName: "{{ APPURL | default('app-' ~ CLUSTER_ID ~ '.live.alta3.com') }}"
    annotations:
      nginx.ingress.kubernetes.io/proxy-body-size: "0"
      nginx.ingress.kubernetes.io/proxy-read-timeout: "600"
      nginx.ingress.kubernetes.io/proxy-send-timeout: "600"
  # (keep your existing service/ingress keys)
  extraEnv:
    - name: CLEARML__enterprise__multi_tenant
      value: "true"

fileserver:
  service: { type: ClusterIP }
  ingress:
    enabled: true
    ingressClassName: nginx
    hostName: "{{ FILESURL | default('files-' ~ CLUSTER_ID ~ '.live.alta3.com') }}"
    annotations:
      nginx.ingress.kubernetes.io/proxy-body-size: "0"
      nginx.ingress.kubernetes.io/proxy-read-timeout: "600"
      nginx.ingress.kubernetes.io/proxy-send-timeout: "600"
  persistence:
    enabled: true
    storageClass: nfs-csi
    size: 50Gi

# Persistence: uses your NFS-CSI default SC
mongodb:
  enabled: true
  architecture: replicaset
  persistence:
    enabled: true
    storageClass: nfs-csi
    size: 20Gi

elasticsearch:
  enabled: true
  master:
    persistence:
      enabled: true
      storageClass: nfs-csi
      size: 50Gi
  data:
    persistence:
      enabled: true
      storageClass: nfs-csi
      size: 100Gi

redis:
  master:
    persistence:
      enabled: true
      storageClass: nfs-csi
